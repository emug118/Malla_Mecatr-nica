<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Curricular - Ingeniería Mecatrónica (EIA)</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f4f7fb;
      padding: 20px;
      margin: 0;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 25px;
    }
    .grid {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 20px;
      padding-bottom: 10px;
    }
    .semestre {
      min-width: 260px;
      background: #fff;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
      flex-shrink: 0;
    }
    .semestre h2 {
      text-align: center;
      font-size: 1.1rem;
      margin-bottom: 10px;
      color: #34495e;
    }
    .materia {
      background: #d7e9f7;
      margin: 8px 0;
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.25s ease;
      position: relative;
      user-select: none;
      font-size: 0.9rem;
      line-height: 1.2;
    }
    .materia.aprobada {
      background: #b6e5a8;
      text-decoration: line-through;
      color: #2c3e50;
      font-weight: 600;
    }
    .materia.bloqueada {
      background: #f2f2f2;
      color: #a1a1a1;
      cursor: not-allowed;
      font-style: italic;
    }
    .materia:not(.bloqueada):hover {
      background: #a9c9ff;
    }
    .tooltip {
      display: none;
      position: absolute;
      top: 50%;
      left: 100%;
      transform: translate(8px, -50%);
      background: rgba(0,0,0,0.75);
      color: #fff;
      padding: 5px 10px;
      border-radius: 6px;
      font-size: 0.75rem;
      max-width: 200px;
      white-space: normal;
      z-index: 10;
    }
    .materia.bloqueada:hover .tooltip {
      display: block;
    }
    /* Scrollbar para la grid horizontal */
    .grid::-webkit-scrollbar {
      height: 8px;
    }
    .grid::-webkit-scrollbar-thumb {
      background: #a3bffa;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Ingeniería Mecatrónica (EIA)</h1>
  <div class="grid" id="malla"></div>

  <script>
    const courses = [
      // Semestre 1
      { name: "Universo Mecatrónico", semester: "Semestre 1", prerequisites: [] },
      { name: "Sistemas Neumáticos e H. Biomorfismos", semester: "Semestre 1", prerequisites: [] },
      { name: "Programación", semester: "Semestre 1", prerequisites: [] },
      { name: "Optativa en Comunicación", semester: "Semestre 1", prerequisites: [] },
      { name: "Geometría", semester: "Semestre 1", prerequisites: [] },
      { name: "Cálculo Diferencial", semester: "Semestre 1", prerequisites: [] },

      // Semestre 2
      { name: "Proyecto I", semester: "Semestre 2", prerequisites: ["Universo Mecatrónico"] },
      { name: "Dibujo Mecánico", semester: "Semestre 2", prerequisites: ["Geometría"] },
      { name: "Programación y Software para Mecatrónicos", semester: "Semestre 2", prerequisites: ["Programación"] },
      { name: "Bases de Datos", semester: "Semestre 2", prerequisites: ["Programación"] },
      { name: "Física Mecánica", semester: "Semestre 2", prerequisites: ["Cálculo Diferencial", "Geometría"] },
      { name: "Álgebra Lineal", semester: "Semestre 2", prerequisites: ["Cálculo Diferencial"] },
      { name: "Cálculo Integral", semester: "Semestre 2", prerequisites: ["Cálculo Diferencial"] },

      // Semestre 3
      { name: "Ciencia de los Materiales", semester: "Semestre 3", prerequisites: ["Sistemas Neumáticos e H. Biomorfismos"] },
      { name: "Termodinámica y Mecánica de Fluidos", semester: "Semestre 3", prerequisites: ["Física Mecánica"] },
      { name: "Optativa Sociohumanística", semester: "Semestre 3", prerequisites: [] },
      { name: "Estática", semester: "Semestre 3", prerequisites: ["Física Mecánica"] },
      { name: "Física de Campos", semester: "Semestre 3", prerequisites: ["Física Mecánica", "Cálculo Integral"] },
      { name: "Cálculo en Varias Variables", semester: "Semestre 3", prerequisites: ["Cálculo Integral"] },

      // Semestre 4
      { name: "Procesos de Transformación", semester: "Semestre 4", prerequisites: ["Ciencia de los Materiales", "Mecánica de Materiales"] },
      { name: "Oleoneumática", semester: "Semestre 4", prerequisites: ["Termodinámica y Mecánica de Fluidos"] },
      { name: "Mecánica de Materiales", semester: "Semestre 4", prerequisites: ["Ciencia de los Materiales", "Estática"] },
      { name: "Dinámica", semester: "Semestre 4", prerequisites: ["Estática"] },
      { name: "Ecuaciones Diferenciales", semester: "Semestre 4", prerequisites: ["Cálculo en Varias Variables"] },
      { name: "Electrónica", semester: "Semestre 4", prerequisites: ["Cálculo Integral"] },

      // Semestre 5
      { name: "Diseño y Manufactura Asistidos", semester: "Semestre 5", prerequisites: ["Dibujo Mecánico"] },
      { name: "Sistemas Mecánicos", semester: "Semestre 5", prerequisites: ["Mecánica de Materiales"] },
      { name: "Modelado y Simulación de Sistemas Mecatrónicos", semester: "Semestre 5", prerequisites: ["Ecuaciones Diferenciales", "Programación y Software para Mecatrónicos"] },
      { name: "Electrónica de Potencia y Máquinas", semester: "Semestre 5", prerequisites: ["Electrónica"] },
      { name: "Ingeniería Económica", semester: "Semestre 5", prerequisites: [] },
      { name: "Señales y Sistemas", semester: "Semestre 5", prerequisites: ["Álgebra Lineal", "Ecuaciones Diferenciales"] },

      // Semestre 6
      { name: "Sistemas Embebidos", semester: "Semestre 6", prerequisites: ["Señales y Sistemas"] },
      { name: "Control de Procesos en Tiempo Continuo", semester: "Semestre 6", prerequisites: ["Modelado y Simulación de Sistemas Mecatrónicos"] },
      { name: "Instrumentación y Automatización de Procesos", semester: "Semestre 6", prerequisites: ["Control de Procesos en Tiempo Continuo"] },
      { name: "Reto de Empresarismo", semester: "Semestre 6", prerequisites: [] },
      { name: "Probabilidad y Estadística", semester: "Semestre 6", prerequisites: ["Cálculo en Varias Variables"] },
      { name: "Innovación Social", semester: "Semestre 6", prerequisites: ["50% créditos aprobados"] },
      { name: "Formulación y Evaluación de Proyectos", semester: "Semestre 6", prerequisites: ["Ingeniería Económica"] },

      // Semestre 7
      { name: "Robótica", semester: "Semestre 7", prerequisites: ["Instrumentación y Automatización de Procesos"] },
      { name: "Control Digital de Sistemas Dinámicos", semester: "Semestre 7", prerequisites: ["Control de Procesos en Tiempo Continuo"] },
      { name: "Redes Industriales", semester: "Semestre 7", prerequisites: ["Sistemas Embebidos"] },
      { name: "Optativa en Gestión y Liderazgo", semester: "Semestre 7", prerequisites: ["40% créditos aprobados"] },
      { name: "Electiva I", semester: "Semestre 7", prerequisites: [] },
      { name: "Electiva II", semester: "Semestre 7", prerequisites: [] },

      // Semestre 8
      { name: "IA en Sistemas Mecatrónicos", semester: "Semestre 8", prerequisites: ["Control Digital de Sistemas Dinámicos"] },
      { name: "Diseño Mecatrónico", semester: "Semestre 8", prerequisites: ["Robótica"] },
      { name: "Innovación Empresarial", semester: "Semestre 8", prerequisites: ["Reto de Empresarismo", "Formulación y Evaluación de Proyectos"] },
      { name: "Electiva III", semester: "Semestre 8", prerequisites: [] },
      { name: "Electiva IV", semester: "Semestre 8", prerequisites: [] },
      { name: "Competencias Ciudadanas", semester: "Semestre 8", prerequisites: ["50% créditos aprobados"] },

      // Semestre 9
      { name: "Electiva V", semester: "Semestre 9", prerequisites: [] },
      { name: "Práctica Empresarial", semester: "Semestre 9", prerequisites: ["65% créditos aprobados"] },
      { name: "Innovación y Emprendimiento", semester: "Semestre 9", prerequisites: ["65% créditos aprobados"] },
      { name: "Investigación", semester: "Semestre 9", prerequisites: ["65% créditos aprobados"] },
      { name: "Intercambio Nacional/Internacional", semester: "Semestre 9", prerequisites: ["65% créditos aprobados"] },
      { name: "Co-terminal con Posgrado", semester: "Semestre 9", prerequisites: ["65% créditos aprobados"] }
    ];

    // Estado guardado en localStorage (materias aprobadas)
    let estado = JSON.parse(localStorage.getItem("estadoMaterias")) || {};

    // Función para contar créditos aprobados
    // Como no tenemos créditos definidos, solo contamos materias aprobadas
    function porcentajeAprobado() {
      const total = courses.length;
      const aprobadas = Object.values(estado).filter(v => v).length;
      return (aprobadas / total) * 100;
    }

    // Verifica si se cumple el requisito especial por porcentaje
    function checkEspecial(prer) {
      if(prer === "50% créditos aprobados") {
        return porcentajeAprobado() >= 50;
      }
      if(prer === "40% créditos aprobados") {
        return porcentajeAprobado() >= 40;
      }
      if(prer === "65% créditos aprobados") {
        return porcentajeAprobado() >= 65;
      }
      return false;
    }

    function renderMalla() {
      const container = document.getElementById("malla");
      container.innerHTML = "";

      // Semestres ordenados
      const semestres = [...new Set(courses.map(c => c.semester))];

      semestres.forEach(sem => {
        const col = document.createElement("div");
        col.className = "semestre";

        const title = document.createElement("h2");
        title.textContent = sem;
        col.appendChild(title);

        const materiasSem = courses.filter(c => c.semester === sem);

        materiasSem.forEach(materia => {
          const div = document.createElement("div");
          div.className = "materia";
          div.textContent = materia.name;

          // Revisa si los prerrequisitos están aprobados
          let faltan = [];

          materia.prerequisites.forEach(p => {
            // prer especial porcentaje
            if(p.endsWith("créditos aprobados")) {
              if(!checkEspecial(p)) faltan.push(p);
            } else {
              if(!estado[p]) faltan.push(p);
            }
          });

          if(estado[materia.name]) {
            div.classList.add("aprobada");
          } else if(faltan.length > 0) {
            div.classList.add("bloqueada");
            const tooltip = document.createElement("div");
            tooltip.className = "tooltip";
            tooltip.textContent = "Faltan: " + faltan.join(", ");
            div.appendChild(tooltip);
          }

          div.addEventListener("click", () => {
            if(div.classList.contains("bloqueada")) return;
            estado[materia.name] = !estado[materia.name];
            localStorage.setItem("estadoMaterias", JSON.stringify(estado));
            renderMalla();
          });

          col.appendChild(div);
        });

        container.appendChild(col);
      });
    }

    renderMalla();
  </script>
</body>
</html>



